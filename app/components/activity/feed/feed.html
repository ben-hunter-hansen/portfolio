<div class="row repeated-item" ng-repeat="post in ctrl.feed" check-update>
    <div class="small-12 medium-10 medium-offset-1 large-8 large-offset-2 columns">
        <div class="row">
            <div class="large-12 columns contents">
                <div class="row">
                    <div class="small-12 medium-10 columns">
                        <h3>
                            {{ post.title }}
                        <span class="subheader">
                             | <small>{{ post.hours_ago }} hour(s) ago</small>
                        </span>
                        </h3>
                    </div>
                    <div class="medium-2 large-2 columns show-for-large-up">
                        <img class="right" style="width: 50px; height: auto" ng-src="{{ post.photo }}"/>
                    </div>
                </div>
                <div class="row">
                    <div class="small-12 columns">
                        <h5 class="subheader">{{ post.body }}</h5>
                    </div>
                </div>
                <hr/>
                <div class="row">
                    <div class="large-10 medium-10 small-8 columns" ng-if="!ctrl.getToggledReply(post._id)">
                        <a href="#" class="button tiny left split no-pip">
                            {{ post.points }} Points
                            <span><i class="fa fa-thumbs-o-up"></i></span>
                        </a>
                    </div>
                    <ng-form name="replyForm">
                        <div class="small-12 columns" ng-if="ctrl.getToggledReply(post._id)">
                            <div class="row">
                                <div class="small-12 columns"
                                     ng-class="{error: replyForm.input.$invalid && replyForm.input.$dirty}">
                                    <label style="font-size: large"> Leave a comment.
                                    <textarea ng-model="post.replyModel.text"
                                              name="input"
                                              ng-required="true"
                                              placeholder="Speak your mind"
                                              class="reply-box"
                                              ng-maxlength="200">
                                    </textarea>
                                        <small class="error"
                                               ng-show="replyForm.input.$invalid && replyForm.input.$dirty">
                                            {{ replyForm.input.$error.maxlength ? "Replies need to be under 200 chars."
                                            : "This is a required field" }}
                                        </small>
                                    </label>
                                </div>
                            </div>
                        </div>
                        <div class="small-12 columns" ng-if="ctrl.getToggledReply(post._id)">
                            <div class="row">
                                <div class="medium-8 columns">
                                    <div class="row">
                                        <div class="small-12 columns">
                                            <div class="row">
                                                <div class="small-8 medium-9 columns" ng-init="anon = true">
                                                    <input ng-if="anon" type="text" placeholder="Identify yourself">
                                                    <ul ng-if="!anon" class="button-group round even-6" toggle-anon>
                                                        <li>
                                                            <a href="#" class="tiny button secondary">
                                                                <i class="fa fa-github"></i>
                                                            </a>
                                                        </li>
                                                        <li>
                                                            <a href="#" class="tiny button secondary">
                                                                <i class="fa fa-stack-overflow"></i>
                                                            </a>
                                                        </li>
                                                        <li>
                                                            <a href="#" class="tiny button secondary">
                                                                <i class="fa fa-reddit"></i>
                                                            </a>
                                                        </li>
                                                        <li>
                                                            <a href="#" class="tiny button secondary">
                                                                <i class="fa fa-facebook-official"></i>
                                                            </a>
                                                        </li>
                                                        <li>
                                                            <a href="#" class="tiny button secondary">
                                                                <i class="fa fa-twitter"></i>
                                                            </a>
                                                        </li>
                                                        <li>
                                                            <a href="#" class="tiny button secondary">
                                                                <i class="fa fa-linkedin"></i>
                                                            </a>
                                                        </li>
                                                    </ul>
                                                </div>
                                                <div class="small-4 medium-3 columns">
                                                    <a href="#" ng-click="anon = !anon" class="tiny round button" ng-class="{success: anon}">
                                                        <i ng-class="{'fa fa-users': anon, 'fa fa-user': !anon}"></i>
                                                    </a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="medium-4 columns">
                                    <ul class="button-group even-2">
                                        <li>
                                            <a href="#" ng-click="ctrl.setToggledReply(post._id)" class="tiny button secondary">Cancel</a>
                                        </li>
                                        <li>
                                            <a href="#"
                                               ng-class="{disabled: replyForm.input.$invalid}"
                                               ng-disabled="replyForm.input.$invalid"
                                               ng-click="ctrl.submitReply(post.replyModel.text,post)"
                                               class="tiny button">Submit
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </ng-form>
                    <div class="large-2 medium-2 small-4 columns" ng-if="!ctrl.getToggledReply(post._id)">
                        <a href="#" ng-click="ctrl.setToggledReply(post._id)" class="tiny button success right">Reply</a>
                    </div>
                    <div class="large-12 columns">
                        <accordion close-others="oneAtATime">
                            <accordion-group is-open="isopen">
                                <accordion-heading>
                                    {{ post.comments.length }} Comments <i class="right icon-adjust"
                                                                           ng-class="{'fa fa-chevron-down': isopen, 'fa fa-chevron-right': !isopen}"></i>
                                </accordion-heading>
                                <div class="row" ng-repeat="comment in post.comments">
                                    <div ng-if="isopen" class="large-2 medium-2 small-3 columns repeated-item-fast"><img
                                            ng-src="{{ comment.photo }}"/></div>
                                    <div ng-if="isopen" class="large-10 medium-10 small-9 columns repeated-item-fast"><p>{{
                                        comment.text }}</p></div>
                                </div>
                            </accordion-group>
                        </accordion>
                    </div>
                </div>
            </div>
        </div>
        <hr/>
    </div>
</div>